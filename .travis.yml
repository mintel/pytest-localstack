language: python
services:
  - docker

python:
  - '2.7'
  - '3.4'
  - '3.5'
  - '3.6'
  - '3.7-dev'
  - 'pypy'
  - 'pypy3'

matrix:
  fast_finish: true
  allow_failures:
    - python: "3.7-dev"

stages:
  - lint
  - test

install: pip install --upgrade -e '.[test]'

script: pytest -ra --cov=pytest_localstack

jobs:
  include:
    - stage: test
      after_success: codecov

    - stage: lint
      python: '3.6'
      services: []
      install: pip install --upgrade pipenv flake8 flake8-debugger flake8-docstrings flake8-isort
      script:
        - pipenv check
        - flake8
